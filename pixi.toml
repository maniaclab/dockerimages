[workspace]
name = "ml-platform"
version = "2026.02.19"
description = "MaNIAC Lab ML platform environment"
channels = ["conda-forge"]
platforms = ["linux-64", "linux-aarch64", "osx-64", "osx-arm64"]

[feature.ml]
platforms = ["linux-64"]

[feature.ml.system-requirements]
cuda = "13.0"

[feature.ml.dependencies]
# Python
python = "==3.12"
pixi-kernel = "*"

# CERN ROOT
root = "*"

# Java (OpenJDK 8 in ml_base)
openjdk = "*"

# ML frameworks
tensorflow-gpu = "*"
keras = "*"

# Data science
numpy = "*"
pandas = "*"
scipy = "*"
scikit-learn = "*"
pyarrow = "*"
h5py = "*"
pytables = "*"
cython = "*"

# Visualization
matplotlib = "*"
seaborn = "*"
bokeh = "*"
graphviz = "*"

# Jupyter ecosystem
jupyter = ">=1.1.1,<2"
jupyterlab_server = ">2.0.1,<3"  # rucio-jupyterlab
jupyterlab = ">=4,<5"  # rucio-jupyterlab
notebook = "<7"  # rucio-jupyterlab

ipykernel = "*"
metakernel = "*"
ipywidgets = "*"
jupyterlab-git = "*"
rise = "*"

# HEP
uproot = "*"
rucio-clients = ">=32.0"  # rucio-jupyterlab

# System tools
curl = "*"
wget = "*"
unzip = "*"
zip = "*"
vim = "*"
jq = "*"
rsync = "*"
git = "*"
make = "*"
compilers = "*"
pkg-config = "*"

# Libraries
freetype = "*"
libpng = "*"
zeromq = "*"
hdf5 = "*"
tbb = "*"
zlib = "*"

# Other
requests = "*"
pillow = "*"
tqdm = "*"
imageio = "*"

[feature.ml.pypi-dependencies]
# Packages NOT on conda-forge (or easier from PyPI)
tensorflow-datasets = "*"
keras-tuner = "*"
plumbum = "*"
jupyter-bokeh = "*"
qtpy = "*"
elasticsearch = "*"
gymnasium = "*"          # gym is deprecated, gymnasium is the successor
JSAnimation = "*"
dask-labextension = "*"
atlasify = "*"
rucio-jupyterlab = "*"

[feature.dev.dependencies]
python = "==3.11"
tbump = "*"

[feature.dev.tasks]
tbump = { cmd = "tbump", description = "Run tbump" }
bump = { cmd = "tbump $(date +\"%Y.%-m.%-d\")", description = "Run tbump with current date" }

[environments]
dev = ["dev"]
ml = ["ml"]
